# LaTeX is currently not supported
# See: http://docs.shippable.com/ci/languages/customImages/#
# !! language: c is not compatible with choosing a custom build imgage
language: none

env:
  - secure: tc6Y6GXGjNuU2FxcrzI/EFa+7v+jB3xD/7cDtE+1PFZvT9U6fdnVDY8s/z4xN4IgXLnCYSHUDeW33eSCcz7EnNWW4bJDH7PWHDee/sFaFUevbMcKVdS+MKYOxF/bdAZIjJ10sUoEdAIdXLCEEpAHBHMfeaSeAzHa0vsebDhwmhJvuwujJ9A89EQW1Tf+vwxC6gO+dm0yJyT9f2Oi481tmlAjr3x5Kaoe0UVa48EMdqGdSg4SPQ6QkivG9AQ8uhnCy9QTlMYpCJ3ZcqpVorq6CMRb7qIBvKF3Wv4k+ZRaYpP8Htn7ikD0rGOqeKgSa7eiSknsDwV4F4ShHCUWR0Kxfg==

build:
  pre_ci_boot:
   # Originally from https://github.com/scottclowe/latex-continuous-integration
   image_name: ubuntu #harshjv/texlive-2015
   image_tag: latest
   pull: true
   
  ci:
    # --
    # 'Install' add-apt-repository for TU Design ( http://exp1.fkp.physik.tu-darmstadt.de/tuddesign/)
    - sudo apt-get install --yes software-properties-common python-software-properties
    - sudo add-apt-repository "deb http://exp1.fkp.physik.tu-darmstadt.de/tuddesign/ lenny tud-design"
    - sudo apt-get update
    - sudo apt-get install --yes --force-yes debian-tuddesign-keyring
    - sudo apt-get update 
    # Install utilities (7z: encrypted archive, build-essential: make, gcc,... ; llvm: clang; texlive: prerequisiste for tudesign)
    - sudo apt-get install --yes p7zip-full build-essential llvm texlive-base-bin texlive-science tex-common xfonts-utils latexmk
    - 7z x 'admin/tudfontsEncrypted.zip' -p"$TUFONTS_DECRYPT_PASSWORD" # The contained files are decompressed into to the repo's root
    - sudo dpkg -i 't1-tudfonts_0.0.20090806_all.deb'
    - sudo dpkg -i 'tex-tudfonts_0.0.20090806_all.deb'
    - sudo apt-get install --yes --force-yes latex-tuddesign 
    # ---
    - EXERCISES_ROOT="$(pwd)/exercises" bash exercises/solutions/make_cpp_projects.sh
    - make -C 'exercises/latex' all
   
  # TODO
  # The following directive instructs Shippable to cache particular files in the container
  # To invalidate the cache, you need to add '[reset_minion]' to a commit message.
  # See: http://docs.shippable.com/ci/caching/
  # cache: true

  
integrations:
  # See http://docs.shippable.com/ci/email-notifications/
  notifications:
    - integrationName: email
      type: email
      sendConsoleLogs: true
      recipients:
        --last_committer
        - roland.kluge@es.tu-darmstadt.de
