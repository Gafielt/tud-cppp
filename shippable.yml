# LaTeX is currently not supported
# See: http://docs.shippable.com/ci/languages/customImages/#
# !! language: c is not compatible with choosing a custom build imgage
language: none

build:
  pre_ci_boot:
   # Originally from https://github.com/scottclowe/latex-continuous-integration
   image_name: harshjv/texlive-2015
   image_tag: latest
   pull: true
   
  ci:
    # ---
    # Update/install TexLive
    # Check texlive version
    - tlmgr version -v
    # Update texlive
    #- tlmgr update --all
    # ---
    # Install TUDesign
    # See http://exp1.fkp.physik.tu-darmstadt.de/tuddesign/
    # ---
    # 'Install' add-apt-repository
    - sudo apt-get install --yes software-properties-common python-software-properties
    - sudo add-apt-repository "deb http://exp1.fkp.physik.tu-darmstadt.de/tuddesign/ lenny tud-design"
    - sudo add-apt-repository "deb-src http://exp1.fkp.physik.tu-darmstadt.de/tuddesign/ lenny tud-design"
    - sudo apt-get update
    - sudo apt-get install --yes debian-tuddesign-keyring
    - sudo apt-get update 
    - sudo apt-get install --yes latex-tuddesign 
    # ---
    # Install C build tools
    # make, gcc,...
    - sudo apt-get install --yes build-essential
    # clang,...
    - sudo apt-get install --yes llvm
    # ---
    # Check texlive version
    - tlmgr version -v
    # Check which tex packages we have available
    - tlmgr info --only-installed || echo "Couldn't retrieve the texlive package list!"
    # Build C++ solutions
    - cd exercises/solutions
    - bash ./make_cpp_projects.sh
    # Build exercise sheets
    - cd exercises/latex
    - make all
   
  # TODO
  # The following directive instructs Shippable to cache particular files in the container
  # To invalidate the cache, you need to add '[reset_minion]' to a commit message.
  # See: http://docs.shippable.com/ci/caching/
  # cache: true

  
integrations:
  # See http://docs.shippable.com/ci/email-notifications/
  notifications:
    - integrationName: email
      type: email
      sendConsoleLogs: true
      recipients:
        --last_committer
        - roland.kluge@es.tu-darmstadt.de
